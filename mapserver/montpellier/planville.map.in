LAYER
    NAME 'MTP_rue'
    GROUP 'plan'
    TYPE LINE
    STATUS ON
    EXTENT 420107 5398192 442381 5412352
    CONNECTIONTYPE postgis
    PROCESSING "CLOSE_CONNECTION=DEFER" # For performance
    CONNECTION "${mapserver_connection}"
    DATA "geom FROM (SELECT geo.geom as geom, len, gid, lib_off FROM geodata.mtp_rue_simple AS geo) AS foo USING UNIQUE gid USING srid=3857"
    PROJECTION
        "init=epsg:3857"
    END
    LABELITEM "lib_off"
    LABELMAXSCALEDENOM 7000
    CLASS
         EXPRESSION ([len] > 100)
         STYLE
         END
         LABEL
             COLOR  50 50 50
             OUTLINECOLOR 255 255 255
             FONT "arial"
             TYPE truetype
             SIZE 7
             ANGLE follow
             POSITION AUTO
             PARTIALS TRUE
             PRIORITY 10
             MINDISTANCE 500
             MINFEATURESIZE 20
             REPEATDISTANCE 200
         END
    END
    METADATA
        "wms_title" "Rue de Montpellier"
        "wms_abstract" "Rue de Montpellier."
        "wms_group_title" "plan"
        "wms_srs" "epsg:3857"
        "gml_include_items" "lib_off"
    END
END

LAYER
    NAME 'MTP_rue2'
    GROUP 'plan'
    TYPE LINE
    STATUS ON
    EXTENT 420107 5398192 442381 5412352
    CONNECTIONTYPE postgis
    PROCESSING "CLOSE_CONNECTION=DEFER" # For performance
    CONNECTION "${mapserver_connection}"
    DATA "geom FROM (SELECT geo.geom as geom, len, gid, lib_off FROM geodata.mtp_rue_simple AS geo) AS foo USING UNIQUE gid USING srid=3857"
    PROJECTION
        "init=epsg:3857"
    END
    LABELITEM "lib_off"
    LABELMAXSCALEDENOM 3000
    CLASS
        EXPRESSION ([len] < 101)
        STYLE
        END
        LABEL
            COLOR  50 50 50
            OUTLINECOLOR 255 255 255
            FONT "arial"
            TYPE truetype
            SIZE 7
            ANGLE follow
            MINDISTANCE 20
            MINFEATURESIZE 20
            REPEATDISTANCE 200
            POSITION AUTO
            PARTIALS FALSE
            PRIORITY 10
        END
    END
    METADATA
        "wms_title" "Rue de Montpellier"
        "wms_abstract" "Rue de Montpellier."
        "wms_group_title" "plan"
        "wms_srs" "epsg:3857"
        "gml_include_items" "lib_off"
    END
END

LAYER
    NAME 'MTP_adresse'
    GROUP 'plan'
    TYPE POINT
    STATUS ON
    EXTENT 420107 5398192 442381 5412352
    CONNECTIONTYPE postgis
    PROCESSING "CLOSE_CONNECTION=DEFER" # For performance
    CONNECTION "${mapserver_connection}"
    DATA "geom FROM (SELECT geo.geom as geom, gid, num_voi FROM geodata.adresse AS geo) AS foo USING UNIQUE gid USING srid=3857"
    PROJECTION
        "init=epsg:3857"
    END
    LABELITEM "num_voi"
    LABELMAXSCALEDENOM 2000
    CLASS
        STYLE
        END
        LABEL
            COLOR  150 150 150
            OUTLINECOLOR 255 255 255
            FONT "arial"
            TYPE truetype
            SIZE 6
            POSITION AUTO
            PARTIALS FALSE
        END
    END
    METADATA
        "wms_title" "Numéro adresse"
        "wms_abstract" "Numéro d'adresse de Montpellier."
        "wms_group_title" "plan"
        "wms_srs" "epsg:3857"
        "gml_include_items" "num_voi"
    END
END

LAYER
    NAME 'MTP_planville'
    GROUP 'plan'
    TYPE POLYGON
    STATUS ON
    TEMPLATE fooOnlyForWMSGetFeatureInfo # For GetFeatureInfo
    EXTENT 420107 5398192 442381 5412352
    CONNECTIONTYPE postgis
    PROCESSING "CLOSE_CONNECTION=DEFER" # For performance
    CONNECTION "${mapserver_connection}"
    DATA "geom FROM (SELECT geo.geom as geom, gid, class FROM geodata.planville AS geo) AS foo USING UNIQUE gid USING srid=3857"
    PROJECTION
        "init=epsg:3857"
    END
    MAXSCALEDENOM 14999
    CLASSITEM "class"
    CLASS
        EXPRESSION "VOIE"
        STYLE
            COLOR 255 255 255
            WIDTH 0.3
            OUTLINECOLOR -1 -1 -1
        END
    END
     CLASS
        EXPRESSION "PIET"
        STYLE
            WIDTH 1
            OUTLINECOLOR 100 100 100
           COLOR 220 220 220
        END
    END
    CLASS
        EXPRESSION "CYCL"
        STYLE
            WIDTH 1
            OUTLINECOLOR 100 100 100
            COLOR 100 100 100
        END
    END
    CLASS
        EXPRESSION "AUTR"
        STYLE
            WIDTH 1
            OUTLINECOLOR 100 100 100
            COLOR 0 0 200
        END
    END
    CLASS
        EXPRESSION "AUTJ"
        STYLE
            WIDTH 1
            OUTLINECOLOR 100 100 100
            COLOR 0 200 0
        END
    END
    CLASS
        EXPRESSION "ILOT"
        STYLE
            WIDTH 1
            OUTLINECOLOR 100 100 100
            COLOR 220 220 220
        END
    END

    METADATA
        "wms_title" "Fond de plan Montpellier" # For WMS
        "wms_srs" "epsg:3857" # For WMS

        "wms_metadataurl_href" "http://opendata.montpelliernumerique.fr/Planville" # For metadata URL
        "wms_metadataurl_format" "text/html" # For metadata URL
        "wms_metadataurl_type" "TC211" # For metadata URL
    END
END

LAYER
    NAME 'mtp_sous_quartiers_label'
    GROUP plan
    TYPE POLYGON
    STATUS ON
    TEMPLATE fooOnlyForWMSGetFeatureInfo # For GetFeatureInfo
    EXTENT 420107 5398192 442381 5412352
    CONNECTIONTYPE postgis
    PROCESSING "CLOSE_CONNECTION=DEFER" # For performance
    CONNECTION "${mapserver_connection}"
    DATA "geom FROM (SELECT geo.geom as geom, libsquart, libquart, gid FROM geodata.sous_quartiers AS geo) AS foo USING UNIQUE gid USING srid=3857"
    PROJECTION
        "init=epsg:3857"
    END
    LABELITEM "libsquart"
    MAXSCALEDENOM 39999
    MINSCALEDENOM 15000
    CLASS
        STYLE
            COLOR 200 200 200
            OUTLINECOLOR 0 0 0
        END
        LABEL
            COLOR  50 50 50
            OUTLINECOLOR 255 255 255
            FONT "arial"
            TYPE truetype
            SIZE 8
            POSITION cc
            PARTIALS FALSE
            MAXSCALEDENOM 39999
            MINSCALEDENOM 15000
        END
    END
    METADATA
        "wms_title" "Sous-quartiers" # For WMS
        "wms_srs" "epsg:3857" # For WMS

        "gml_include_items" ""  # For GetFeatureInfo and WFS GetFeature (QuerryBuilder)
        "ows_geom_type" "polygon" # For returning geometries in GetFeatureInfo
        "ows_geometries" "geom" # For returning geometries in GetFeatureInfo

        "wms_metadataurl_href" "http://opendata.montpelliernumerique.fr/Sous-quartiers" # For metadata URL
        "wms_metadataurl_format" "text/html" # For metadata URL
        "wms_metadataurl_type" "TC211" # For metadata URL
    END
END

LAYER
    NAME 'mtp_quartiers_label'
    GROUP plan
    TYPE POLYGON
    STATUS ON
    TEMPLATE fooOnlyForWMSGetFeatureInfo # For GetFeatureInfo
    EXTENT 420107 5398192 442381 5412352
    CONNECTIONTYPE postgis
    PROCESSING "CLOSE_CONNECTION=DEFER" # For performance
    CONNECTION "${mapserver_connection}"
    DATA "geom FROM (SELECT geo.geom as geom, libquart, gid FROM geodata.quartiers AS geo) AS foo USING UNIQUE gid USING srid=3857"
    PROJECTION
        "init=epsg:3857"
    END
    LABELITEM "libquart"
    MAXSCALEDENOM 150000
    MINSCALEDENOM 40000
    CLASS
        STYLE
            COLOR 150 150 150
            OUTLINECOLOR 0 0 0
        END
        LABEL
            COLOR  50 50 50
            OUTLINECOLOR 255 255 255
            FONT "arial"
            TYPE truetype
            SIZE 8
            POSITION cc
            PARTIALS FALSE
            MAXSCALEDENOM 150000
            MINSCALEDENOM 40000
        END
    END
    METADATA
        "wms_title" "Quartiers" # For WMS
        "wms_srs" "epsg:3857" # For WMS

        "gml_include_items" ""  # For GetFeatureInfo and WFS GetFeature (QuerryBuilder)
        "ows_geom_type" "polygon" # For returning geometries in GetFeatureInfo
        "ows_geometries" "geom" # For returning geometries in GetFeatureInfo

        "wms_metadataurl_href" "http://opendata.montpelliernumerique.fr/Quartiers" # For metadata URL
        "wms_metadataurl_format" "text/html" # For metadata URL
        "wms_metadataurl_type" "TC211" # For metadata URL

    END
END

LAYER
    NAME 'ortho_montpellier'
    GROUP 'ortho'
    TYPE RASTER
    PROJECTION
        "init=epsg:2154"
    END
    STATUS ON
    DATA Ortho/VilleMTP_MTP_OrthoPhoto_2011.ecw
    PROCESSING "RESAMPLE=AVERAGE"
    METADATA
        "wms_title" "Ortho montpellier" # For WMS
        "wms_group_title" "ortho"
        "wms_srs" "epsg:3857" # For WMS
    END
END
