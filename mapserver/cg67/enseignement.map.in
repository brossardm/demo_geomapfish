LAYER
    NAME 'cg67_metier_ens_lycees'
    TYPE POINT
    STATUS ON
    TEMPLATE fooOnlyForWMSGetFeatureInfo # For GetFeatureInfo
    CONNECTIONTYPE postgis
    PROCESSING "CLOSE_CONNECTION=DEFER" # For performance
    CONNECTION "${mapserver_connection}"
    DATA "geom FROM (SELECT geo.the_geom as geom, ogc_fid AS gid, nom, adresse, commentaire FROM cg67.metier_ens_lycees geo, ${mapserver_join_tables} WHERE ST_Contains(${mapserver_join_area}, geo.the_geom) AND ${mapserver_join_where} 'cg67_metier_ens_lycees') AS foo USING UNIQUE gid USING srid=3857"
    PROJECTION
        "init=epsg:3857"
    END
    OPACITY 80
    TOLERANCE 10
    MAXSCALEDENOM 30000
    LABELITEM "ogr_atr_val"
    CLASS
        NAME "Lycées"
        STYLE
            SIZE 10
            SYMBOL "circle"
            OUTLINECOLOR 20 20 20
            COLOR 195 195 0
        END
        LABEL
            ANGLE [ogr_angle]
            COLOR  50 50 50
            OUTLINECOLOR 255 255 255
            FONT "arial"
            TYPE truetype
            SIZE 8
            POSITION lc
            PARTIALS FALSE
            MAXSCALEDENOM 3000
        END
    END

    METADATA
        "wms_title" "Lycées CG67 (label)" # For WMS
        "wms_srs" "epsg:3857" # For WMS

        "gml_include_items" "nom,adresse,commentaire"  # For GetFeatureInfo and WFS GetFeature (QuerryBuilder)
        "ows_geom_type" "point" # For returning geometries in GetFeatureInfo
        "ows_geometries" "geom" # For returning geometries in GetFeatureInfo

        "wms_metadataurl_href" "" # For metadata URL
        "wms_metadataurl_format" "text/html" # For metadata URL
        "wms_metadataurl_type" "TC211" # For metadata URL

        ${mapserver_layer_metadata} # For secured layers
    END
    VALIDATION
        ${mapserver_layer_validation}
    END
END

LAYER
    NAME 'cg67_colleges'
    TYPE POINT
    STATUS ON
    #DEBUG 5
    TEMPLATE fooOnlyForWMSGetFeatureInfo # For GetFeatureInfo
    CONNECTIONTYPE postgis
    PROCESSING "CLOSE_CONNECTION=DEFER" # For performance
    CONNECTION "${mapserver_connection}"
    DATA "geom FROM (SELECT geo.the_geom as geom, ogc_fid AS gid, denominati, adresse_du, numero_de_ AS numero_de FROM cg67.colleges geo, ${mapserver_join_tables} WHERE ST_Contains(${mapserver_join_area}, geo.the_geom) AND ${mapserver_join_where} 'cg67_colleges') AS foo USING UNIQUE gid USING srid=3857"
    PROJECTION
        "init=epsg:3857"
    END
    OPACITY 80
    TOLERANCE 10
    MAXSCALEDENOM 30000
    LABELITEM "ogr_atr_val"
    CLASS
        NAME "Collèges"
        STYLE
            SIZE 10
            SYMBOL "circle"
            OUTLINECOLOR 20 20 20
            COLOR 135 135 0
        END
        LABEL
            ANGLE [ogr_angle]
            COLOR  50 50 50
            OUTLINECOLOR 255 255 255
            FONT "arial"
            TYPE truetype
            SIZE 8
            POSITION lc
            PARTIALS FALSE
            MAXSCALEDENOM 3000
        END
    END

    METADATA
        "wms_title" "Collèges CG67" # For WMS
        "wms_srs" "epsg:3857" # For WMS

        "gml_include_items" "denominati,adresse_du,numero_de"  # For GetFeatureInfo and WFS GetFeature (QuerryBuilder)
        "ows_geom_type" "point" # For returning geometries in GetFeatureInfo
        "ows_geometries" "geom" # For returning geometries in GetFeatureInfo

        "wms_metadataurl_href" "" # For metadata URL
        "wms_metadataurl_format" "text/html" # For metadata URL
        "wms_metadataurl_type" "TC211" # For metadata URL

        ${mapserver_layer_metadata} # For secured layers
    END
    VALIDATION
        ${mapserver_layer_validation}
    END
END

# Cette couche n'est pas topologiquement correct!
LAYER
    NAME 'cg67_metier_ens_secteur_recrutement'
    TYPE POLYGON
    STATUS ON
    TEMPLATE fooOnlyForWMSGetFeatureInfo # For GetFeatureInfo
    CONNECTIONTYPE postgis
    PROCESSING "CLOSE_CONNECTION=DEFER" # For performance
    CONNECTION "${mapserver_connection}"
    DATA "geom FROM (SELECT geo.the_geom as geom, ogc_fid AS gid FROM cg67.metier_ens_secteur_recrutement geo, ${mapserver_join_tables} WHERE ST_Contains(${mapserver_join_area}, geo.the_geom) AND ${mapserver_join_where} 'cg67_metier_ens_secteur_recrutement') AS foo USING UNIQUE gid USING srid=3857"
    PROJECTION
        "init=epsg:3857"
    END
    OPACITY 50
    MAXSCALEDENOM 51000
    CLASS
        NAME "Secteur recrutement"
        STYLE
            WIDTH 1
            OUTLINECOLOR 255 255 192
            COLOR 92 155 92
        END
    END

    METADATA
        "wms_title" "Secteur recrutement CG67" # For WMS
        "wms_srs" "epsg:3857" # For WMS

        "gml_include_items" "gid"  # For GetFeatureInfo and WFS GetFeature (QuerryBuilder)
        "ows_geom_type" "polygon" # For returning geometries in GetFeatureInfo
        "ows_geometries" "geom" # For returning geometries in GetFeatureInfo

        "wms_metadataurl_href" "http://www.bas-rhin.fr/posplu/index.aspx" # For metadata URL
        "wms_metadataurl_format" "text/html" # For metadata URL
        "wms_metadataurl_type" "TC211" # For metadata URL

        ${mapserver_layer_metadata} # For secured layers
    END
    VALIDATION
        ${mapserver_layer_validation}
    END
END
